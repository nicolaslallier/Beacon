# Beacon NGINX & Monitoring Stack Environment

# Core NGINX reverse proxy
NGINX_HTTP_PORT=80
TECHNITIUM_DNS_PORT=53
TECHNITIUM_API_URL=http://localhost:5380
TECHNITIUM_API_KEY=c61dc87de95df88f4ccee0d67ca0288c9c75fbfa4c5b9654637de226a9d6c18e
TECHNITIUM_N8N_HOST=n8n.beacon.famillelallier.net
TECHNITIUM_PGADMIN_HOST=pgadmin.beacon.famillelallier.net
TECHNITIUM_GRAFANA_HOST=grafana.beacon.famillelallier.net
TECHNITIUM_KEYCLOAK_HOST=keycloak.beacon.famillelallier.net
TECHNITIUM_DNS_HOST=dns.beacon.famillelallier.net
TECHNITIUM_MINIO_HOST=minio.beacon.famillelallier.net
TECHNITIUM_BEACON_OLLAMA_HOST=beacon-ollama.beacon.famillelallier.net
TECHNITIUM_BEACON_OLLAMA_WEBUI_HOST=beacon-ollama-webui.beacon.famillelallier.net
TECHNITIUM_OLLAMA_HOST=ollama.beacon.famillelallier.net
TECHNITIUM_LMSTUDIO_HOST=lmstudio.beacon.famillelallier.net
TECHNITIUM_POSTGRESQL_HOST=postgresql.beacon.famillelallier.net
TECHNITIUM_REDIS_HOST=redis.beacon.famillelallier.net
TECHNITIUM_SUPABASE_HOST=supabase.beacon.famillelallier.net
TECHNITIUM_CHROMADB_HOST=chromadb.beacon.famillelallier.net
UPSTREAM_WEB_HOST=web
UPSTREAM_WEB_PORT=3000
UPSTREAM_API_HOST=api
UPSTREAM_API_PORT=8080
MAX_BODY_SIZE=50m
GZIP_ENABLED=on

# Monitoring stack
GRAFANA_PORT=3000
GF_SECURITY_ADMIN_PASSWORD=Moine101!!01

# Optional: Un-comment to override default internal ports
# PROMETHEUS_PORT=9090
# LOKI_PORT=3100
# TEMPO_PORT=3200
# =============================================================================
# Let's Encrypt / SSL Configuration
# =============================================================================

# Email for Let's Encrypt certificate notifications
LETSENCRYPT_EMAIL=admin@famillelallier.net

# Certbot paths (relative to infra/docker-compose.yml)
CERTBOT_WWW_PATH=./certbot/www
CERTBOT_CONF_PATH=./certbot/conf

# SSL certificate paths (where nginx expects them)
SSL_CERTS_PATH=../config/certs
SSL_CERT_PATH=/etc/nginx/certs/fullchain.pem
SSL_KEY_PATH=/etc/nginx/certs/privkey.pem

# =============================================================================
# API Gateway (Traefik + OAuth2 Proxy)
# =============================================================================
UPSTREAM_GATEWAY_HOST=beacon-traefik
UPSTREAM_GATEWAY_PORT=8080

# OAuth2 Proxy (Keycloak OIDC)
OAUTH2_PROXY_PROVIDER=keycloak-oidc
OAUTH2_PROXY_OIDC_ISSUER_URL=http://beacon-keycloak:8080/realms/beacon
OAUTH2_PROXY_SKIP_OIDC_DISCOVERY=true
OAUTH2_PROXY_LOGIN_URL=https://keycloak.beacon.famillelallier.net/realms/beacon/protocol/openid-connect/auth
OAUTH2_PROXY_REDEEM_URL=http://beacon-keycloak:8080/realms/beacon/protocol/openid-connect/token
OAUTH2_PROXY_OIDC_JWKS_URL=http://beacon-keycloak:8080/realms/beacon/protocol/openid-connect/certs
OAUTH2_PROXY_REDIRECT_URL=https://beacon-library.famillelallier.net/oauth2/callback
OAUTH2_PROXY_INSECURE_OIDC_SKIP_ISSUER_VERIFICATION=true
OAUTH2_PROXY_CLIENT_ID=beacon-gateway
OAUTH2_PROXY_CLIENT_SECRET=Yhu28IUWcfU9BFQoXofRUmrDNEyRfD88
OAUTH2_PROXY_COOKIE_SECRET=FRWzeMPp+TQvL+joSwa6pbwE0mb9uWe/
OAUTH2_PROXY_EMAIL_DOMAINS=*
OAUTH2_PROXY_INSECURE_OIDC_ALLOW_UNVERIFIED_EMAIL=true
OAUTH2_PROXY_COOKIE_SECURE=true
OAUTH2_PROXY_WHITELIST_DOMAINS=.famillelallier.net
OAUTH2_PROXY_COOKIE_DOMAINS=.famillelallier.net
OAUTH2_PROXY_REVERSE_PROXY=true

# Keycloak hostname (used by container config)
KEYCLOAK_HOSTNAME=keycloak.beacon.famillelallier.net
KEYCLOAK_HOSTNAME_PORT=443
KEYCLOAK_HOSTNAME_STRICT=false
KEYCLOAK_HOSTNAME_STRICT_HTTPS=false

# Beacon Library upstreams (NGINX)
UPSTREAM_BEACON_LIBRARY_HOST=beacon-library-frontend
UPSTREAM_BEACON_LIBRARY_PORT=3000
UPSTREAM_MCP_VECTOR_HOST=beacon-library-mcp-vector
UPSTREAM_MCP_VECTOR_PORT=8001
UPSTREAM_OLLAMA_HOST=beacon-library-ollama
UPSTREAM_OLLAMA_PORT=11434

# VectorDB upstreams (NGINX stream)
UPSTREAM_VECTORDB_HOST=beacon-vectordb
UPSTREAM_VECTORDB_PORT=5432

# PgAdmin (VectorDB) upstreams (NGINX)
UPSTREAM_PGADMIN_HOST=pgadmin
UPSTREAM_PGADMIN_PORT=80
UPSTREAM_PGADMIN_VECTORDB_HOST=pgadmin-vectordb
UPSTREAM_PGADMIN_VECTORDB_PORT=80

# Technitium DNS admin upstream (NGINX)
UPSTREAM_TECHNITIUM_HOST=technitium
UPSTREAM_TECHNITIUM_PORT=5380

# PgAdmin default credentials
PGADMIN_EMAIL=admin@beacon.famillelallier.net
PGADMIN_PASSWORD=change_me

# Beacon Library frontend auth
VITE_KEYCLOAK_URL=https://keycloak.beacon.famillelallier.net

